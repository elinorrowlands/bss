doctype html
head
    meta(charset='UTF-8')
    meta(name='viewport' content='width=device-width, initial-scale=1.0')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/tone/13.4.9/Tone.js')
    script(src='../../main.js')
    link(rel='stylesheet', href='../../style.css')
    title BSS: Bridge
    style.
        body {
            transition: background-color 0.1s;
            touch-action:none;
            overflow:hidden;
        }

        .liminal { 
            transition: all 0.5s ease;
        }

        #interactive {
            position: absolute;
            top: 0;
            left: 0;
            right:0;
            bottom:0;
            width: 100%;
            height: 100%;
            margin:auto;
        }
        #backdrop{
            opacity:0.6;
        }

    
body(onload="loader()")
    #backdrop
    main.container
        #toolbar.allowDefault(style='display:none;')
            #play__container
                button#play PLAY
            #effect__container
                label(for='effect__echo') Echo time
                input#effect__echo.fader(type='range' min='0' max='1' step='0.01' value='0.5')
                label(for='effect__echo') Echo amount
                input#effect__echo.fader(type='range' min='0' max='1' step='0.01' value='0.5')
                label(for='effect__lpf') Lowpass filter
                input#effect__lpf.fader(type='range' min='0' max='1' step='0.01' value='0.5')
                label(for='effect__comb__time') Comb time
                input#effect__comb__time.fader(type='range' min='0.1' max='0.9' step='0.01' value='0.5')
                label(for='effect__comb__feedback') Comb resonance
                input#effect__comb__feedback.fader(type='range' min='0' max='0.9' step='0.01' value='0.5')
            #colour-picker__container
                label(for='colour-picker') Colour picker
                input#colour-picker(type='color' value='#0000ff')
            #states__containers
                button#states__save__1 SAVE 1
                button#states__save__2 SAVE 2
                input#states__interpolate(type='range' min='0' max='1' step='0.01' value='0')
        #footer(style="display:none;")
            #credit
                p Bird effect crossfade sketch by Charles Matthews as part of the R&D for Biodiverse Sites and Sounds, 2023
                p Sounds of the Grand Union Canal (Kensal Green) by <a href=https://freesound.org/people/deleted_user_1654820/sounds/98823/>deleted_user_1654820</a> on <a href=https://freesound.org/>freesound.org</a>.  Sound file licensed under the <a href="https://creativecommons.org/licenses/by-nc/3.0/">CC Noncommercial 3.0 license</a>.
    div#interactive
        svg#interactive__svg(version='1.1' xmlns='http://www.w3.org/2000/svg' viewbox='0 0 100 100' preserveaspectratio='none' height='80vh' style="opacity:0;")
            defs 
                linearGradient#gradient(x1='0%' y1='0%' x2='100%' y2='0%')
                    stop(offset='0%' stop-color='white')
                    stop(offset='50%' stop-color='black')
                    stop(offset='100%' stop-color='white')
                mask#cover__img--mask 
                    rect#cover__img--mask(x='0' y='0' width='100' height='200' fill='white' )
                    rect#cover__img--mask__bottom(x='0' y='25' width='100' height='25' fill='black' style='transition:all 0.5s ease;')
                    rect#cover__img--mask__top(x='0' y='0' width='100' height='10' fill='black' style='transition:all 0.5s ease;')
                style.
                    .bridge{
                        fill: url(#gradient);
                        transition:opacity 0.1s;
                        opacity:0.8;
                    }

                    .liminal{
                        transition: all 0.5s ease;
                    }
                    
                    .cover{
                        transition:opacity 2s, fill 3s;
                        
                    }
            //- g#bridge__group(style='opacity:1;')
            //-     rect#bridge__rect.interact.bridge(x='25' y='25' width='50' height='50' fill='url(#gradient)')
            //- g#cover__group(style='opacity:1;')
            //-     rect#cover__rect.interact.cover(x='0' y='0' width='100' height='100' fill='navy')
            //-     image#cover__img.interact.cover(href="photo_elinor.png" mask="url(#cover__img--mask)" alt="photo" style="opacity:1; border:1px; transform-origin:center; transform:translate(25px, 25px);" x='0' y='0' width='50')
            //- g#mask__test 
                //- rect(x='0' y='0' width='30' height='20' fill='white')
                //- rect#cover__img--mask__rect(x='0' y='0' width='100' height='100' fill='black')
        include bridge_svg.html
script(src='conversions.js')
script(src='setInteractions.js')
script(src='loader.js')
script.
    let loadScript = loadingIndicator.init()
    document.querySelectorAll('#water_group1 path').forEach((x,i)=>{
        x.classList.add('interact')
        x.classList.add('path')
        x.id=`water${i}`
    })